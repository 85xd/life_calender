<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Life Calendar</title>

<style>
:root{
  --bg:#000;
  --lived:#fff;
  --future:#1f1f1f;
  --current:#ff3b30;
  --text:#f5f5f5;
  --muted:#9a9a9a;
}

html,body{
  margin:0;
  padding:0;
  background:var(--bg);
  font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;
  -webkit-font-smoothing:antialiased;
}

.canvas{
  width:1179px;
  height:2556px;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  align-items:center;
  background:var(--bg);
  padding-top:320px;
  padding-bottom:780px;
  gap:70px;
}

svg{
  display:block;
  shape-rendering:geometricPrecision;
  width:1050px;
  height:auto;
}

.stats{
  text-align:center;
}

.headline{
  font-size:86px;
  font-weight:900;
  letter-spacing:-3px;
  color:var(--text);
  margin-bottom:36px;
}

.row{
  display:flex;
  justify-content:center;
  align-items:baseline;
  gap:52px;
  flex-wrap:wrap;
}

.number{
  font-size:48px;
  font-weight:900;
  color:var(--text);
}

.label{
  font-size:20px;
  font-weight:500;
  color:var(--muted);
  margin-left:8px;
}

.secondary{
  margin-top:26px;
}
</style>
</head>

<body>
<div class="canvas">
  <svg id="calendar"></svg>

  <div class="stats">
    <div class="headline" id="headline"></div>
    <div class="row" id="row1"></div>
    <div class="row secondary" id="row2"></div>
  </div>
</div>

<script>
const BIRTHDATE = new Date("2002-02-07T00:00:00");
const YEARS = 90;
const COLS = 52;
const ROWS = YEARS;

const GAP = 8;
const DOT = 5;
const PAD = 16;

function atMidnight(d){
  return new Date(d.getFullYear(), d.getMonth(), d.getDate());
}

function weeksBetween(a,b){
  return Math.floor((atMidnight(b)-atMidnight(a)) / (7*24*60*60*1000));
}

function daysBetween(a,b){
  return Math.floor((atMidnight(b)-atMidnight(a)) / (24*60*60*1000));
}

function clamp(n,min,max){
  return Math.min(Math.max(n,min),max);
}

function formatNumber(n){
  return new Intl.NumberFormat("de-DE").format(n);
}

function render(){
  const now = new Date();
  const totalWeeks = ROWS * COLS;

  const livedWeeks = clamp(weeksBetween(BIRTHDATE, now), 0, totalWeeks);
  const remainingWeeks = totalWeeks - livedWeeks;
  const percent = (livedWeeks / totalWeeks) * 100;

  const daysOld = daysBetween(BIRTHDATE, now);
  const yearsOld = Math.floor(daysOld / 365.2425);
  const daysRemainder = Math.round(daysOld - yearsOld * 365.2425);

  document.getElementById("headline").textContent = percent.toFixed(1) + "%";

  document.getElementById("row1").innerHTML =
    '<div><span class="number">' + yearsOld + '</span><span class="label">Jahre</span></div>' +
    '<div><span class="number">' + daysRemainder + '</span><span class="label">Tage</span></div>';

  document.getElementById("row2").innerHTML =
    '<div><span class="number">' + formatNumber(livedWeeks) + '</span><span class="label">Wochen</span></div>' +
    '<div><span class="number">' + formatNumber(remainingWeeks) + '</span><span class="label">Verbleibend</span></div>';

  const svg = document.getElementById("calendar");
  svg.innerHTML = "";

  const gridW = (COLS - 1) * GAP;
  const gridH = (ROWS - 1) * GAP;
  const viewW = gridW + PAD*2;
  const viewH = gridH + PAD*2;

  svg.setAttribute("viewBox", "0 0 " + viewW + " " + viewH);

  const NS = "http://www.w3.org/2000/svg";
  const bg = document.createElementNS(NS,"rect");
  bg.setAttribute("width", viewW);
  bg.setAttribute("height", viewH);
  bg.setAttribute("fill", "var(--bg)");
  svg.appendChild(bg);

  const radius = DOT/2;
  const currentIndex = clamp(livedWeeks, 0, totalWeeks - 1);

  let index = 0;
  for(let r=0; r<ROWS; r++){
    for(let c=0; c<COLS; c++){
      const dot = document.createElementNS(NS,"circle");
      dot.setAttribute("cx", PAD + c*GAP);
      dot.setAttribute("cy", PAD + r*GAP);
      dot.setAttribute("r", radius);

      if(index < livedWeeks) dot.setAttribute("fill","var(--lived)");
      else if(index === currentIndex) dot.setAttribute("fill","var(--current)");
      else dot.setAttribute("fill","var(--future)");

      svg.appendChild(dot);
      index++;
    }
  }
}

render();
</script>

</body>
</html>